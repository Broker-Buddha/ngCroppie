!function(){"use strict";angular.module("ngCroppie",[]).directive("ngCroppie",["$timeout",function(e){return{restrict:"AE",scope:{src:"=",rotation:"=",viewport:"=",boundry:"=",type:"@",zoom:"@",mousezoom:"@",zoomslider:"@",exif:"@",enforceBoundary:"@",orientation:"@",update:"=",ngModel:"=",mobile:"@",result:"="},link:function(n,e,o){void 0===n.viewport&&(n.viewport={w:null,h:null}),void 0===n.boundry&&(n.boundry={w:null,h:null}),void 0===n.result?n.result={type:"canvas"}:void 0===n.result.type&&(n.result.type="canvas"),"true"===n.mobile?(n.viewport.w=250,n.viewport.h=250,n.boundry.w=300,n.boundry.h=300):(n.viewport.w=void 0!==n.viewport.w?n.viewport.w:300,n.viewport.h=void 0!==n.viewport.h?n.viewport.h:300,n.boundry.w=void 0!==n.boundry.w?n.boundry.w:400,n.boundry.h=void 0!==n.boundry.h?n.boundry.h:400),n.viewport.w>n.boundry.w&&(n.viewport.w=n.boundry.w),n.viewport.h>n.boundry.h&&(n.viewport.h=n.boundry.h);var t="true"===n.zoom||void 0===n.zoom,r="true"===n.mousezoom||void 0===n.mousezoom,i="true"===n.zoomslider||void 0===n.zoomslider,u={viewport:{width:n.viewport.w,height:n.viewport.h,type:n.type||"square"},boundary:{width:n.boundry.w,height:n.boundry.h},enableZoom:t,mouseWheelZoom:r,showZoomer:i,enableExif:n.exif,enforceBoundary:n.enforceBoundary,enableOrientation:n.orientation};void 0!==n.update&&(u.update=n.update);var d,l=new Croppie(e[0],u),a=angular.element(e[0])[0];angular.element(e[0].getElementsByClassName("cr-boundary"))[0].getBoundingClientRect();a.addEventListener("mousedown",function(){d=window.setInterval(function(){l.result(n.result).then(function(e){n.$apply(function(){n.ngModel=e})})},100)},!1),r&&(a.addEventListener("mousewheel",function(e){e.preventDefault(),l.result(n.result).then(function(e){n.$apply(function(){n.ngModel=e})})},!1),a.addEventListener("DOMMouseScroll",function(e){e.preventDefault(),l.result(n.result).then(function(e){n.$apply(function(){n.ngModel=e})})},!1)),a.addEventListener("mouseup",function(){clearInterval(d)},!1),a.addEventListener("mouseleave",function(){clearInterval(d)},!1),a.addEventListener("mouseout",function(){clearInterval(d)},!1),n.$on("$destroy",function(e){clearInterval(d)}),n.$watch("rotation",function(e,o){if("false"===n.orientation||void 0===n.orientation)throw"ngCroppie: Cannot rotate without 'orientation' option";l.rotate(e-o),l.result(n.result).then(function(e){n.$apply(function(){n.ngModel=e})})}),n.$watch("src",function(e,o){if(void 0===n.src)throw"ngCroppie: Image source undefined!";l.bind(n.src),window.setInterval(function(){l.result(n.result).then(function(e){n.$apply(function(){n.ngModel=e})})},0)})}}}])}();